(()=>{"use strict";var e,t={"0zfD":(e,t,n)=>{n.d(t,{ajaxNonce:()=>s,ajaxUrl:()=>a});const o=window?.tec?.tickets?.seating?.ajaxData,{ajaxUrl:a,ajaxNonce:s,ACTION_GET_SEAT_TYPES_BY_LAYOUT_ID:i,ACTION_INVALIDATE_MAPS_LAYOUTS_CACHE:r,ACTION_INVALIDATE_LAYOUTS_CACHE:c,ACTION_DELETE_MAP:d,ACTION_DELETE_LAYOUT:l,ACTION_ADD_NEW_LAYOUT:u,ACTION_DUPLICATE_LAYOUT:_,ACTION_POST_RESERVATIONS:f,ACTION_CLEAR_RESERVATIONS:p,ACTION_FETCH_ATTENDEES:m,ACTION_DELETE_RESERVATIONS:T,ACTION_SEAT_TYPES_UPDATED:E,ACTION_SEAT_TYPE_DELETED:g,ACTION_RESERVATIONS_UPDATED_FROM_SEAT_TYPES:A,ACTION_RESERVATION_CREATED:h,ACTION_RESERVATION_UPDATED:v,ACTION_EVENT_LAYOUT_UPDATED:O,ACTION_REMOVE_EVENT_LAYOUT:y}=o},"Lc+o":(e,t,n)=>{n.d(t,{onReady:()=>o});const o=e=>{"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}},v7al:(e,t,n)=>{n.r(t),n.d(t,{init:()=>S});var o=n("Lc+o");const a=window.tec.tickets.seating.serviceData,s=a.baseUrl.replace(/\/$/,""),i=a.mapsHomeUrl.replace(/\/$/,""),r=a.layoutsHomeUrl.replace(/\/$/,"");function c(){return s.split("?")[0]}a.associatedEventsUrl.replace(/\/$/,"");const d="app_postmessage_ready",l="host_postmessage_ready",u="app_postmessage_set_element_height",_="app_postmessage_map_created_updated",f="app_postmessage_layout_created_updated",p="app_postmessage_seat_type_created_updated",m="app_postmessage_goto_maps_home",T="app_postmessage_goto_layouts_home";var E=n("0zfD");function g(e){console.debug("Message received from service",e)}async function A(){const e=new URL(E.ajaxUrl);return e.searchParams.set("_ajax_nonce",E.ajaxNonce),e.searchParams.set("action","tec_tickets_seating_service_invalidate_layouts_cache"),200===(await fetch(e.toString(),{method:"POST"})).status||(console.error("Invalidation of layouts cache failed, clean the transients manually to fetch up-to-date layouts from the service."),!1)}const h={ready:!1,establishingReadiness:!1,actionsMap:{default:g,[_]:function(){!async function(){const e=new URL(E.ajaxUrl);e.searchParams.set("_ajax_nonce",E.ajaxNonce),e.searchParams.set("action","tec_tickets_seating_service_invalidate_maps_layouts_cache"),200===(await fetch(e.toString(),{method:"POST"})).status||console.error("Invalidation of maps and layouts cache failed, clean the transients manually to fetch up-to-date maps and layouts from the service.")}()},[f]:function(){A()},[p]:function(){A()},[m]:function(){i?window.location.href=i:console.error("Maps home url not found")},[T]:function(){r?window.location.href=r:console.error("Layouts home url not found")}},token:null};function v(e,t){h.actionsMap[e]=t}let O=[];function y(){if(0===O.length)return;const[e,t,n]=O[0],o=function(e){return async t=>{await e(t),O.shift(),y()}}(t);o(n.data.data)}function w(e){if(e.origin!==c()||!e.data.token||e.data.token!==h.token)return;const t=e.data.action;if(!t)return void console.error("No action found in message");const n=function(e){return h.actionsMap[e]||h.actionsMap.default||g}(t);O.push([t,n,e]),O.length>1||y()}async function k(e){let t;!function(e){const t=e.closest("[data-token]");if(!t)return void console.error("No token provider found in iframe element");const n=t.dataset.token;n?(function(e){h.token=e}(n),window.addEventListener("message",w)):console.error("No token found in token provider element")}(e);const n=new Promise(((n,a)=>{t=a,v(d,(()=>{var t;t=d,delete h.actionsMap[t],h.ready=true,h.establishingReadiness=false,function(e,t){const n=e.closest("[data-token]").dataset.token;n?e.contentWindow.postMessage({action:t,token:n,data:null},c()):console.error("No token found in iframe element")}(e,l),clearTimeout(o),console.debug("Readiness established."),n()}))})),o=setTimeout((()=>{t(new Error("Connection to service timed out"))}),3e3);return e.src=e.dataset.src,n}const{_x}=wp.i18n;async function N(e){if(!e)return!1;const t=e.closest(".tec-tickets-seating__iframe-container");if(!t)return!1;if(!t.dataset.token){const e=_x("Ephemeral token not found in iframe element.","Error message","event-tickets");return function(e){const t=document.getElementById("tec-tickets-seating-notice");(function(e){e&&(e.style.display="none",e.style.visibility="hidden")})(t),function(e,t){if(!e)return;const n=e.classList;n.remove("notice-success"),n.remove("notice-warning"),n.remove("notice-error"),n.add(t)}(t,"notice-error"),function(e,t){e&&(e.innerHTML="<p>"+t+"</p>")}(t,e),function(e){e&&(e.style.display="block",e.style.visibility="visible")}(t)}(t.dataset.error||e),!1}return await k(e),!0}function I(e){return(e=e||document).querySelector(".tec-tickets-seating__iframe-container iframe")}async function S(e){e=e||document,v(u,(t=>function(e,t){I(t).style.height=e.height+"px"}(t,e))),await async function(e){return await N(e),e}(I(e))}(0,o.onReady)((()=>{S(document)}))}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,o),s.exports}o.m=t,e=[],o.O=(t,n,a,s)=>{if(!n){var i=1/0;for(l=0;l<e.length;l++){for(var[n,a,s]=e[l],r=!0,c=0;c<n.length;c++)(!1&s||i>=s)&&Object.keys(o.O).every((e=>o.O[e](n[c])))?n.splice(c--,1):(r=!1,s<i&&(i=s));if(r){e.splice(l--,1);var d=a();void 0!==d&&(t=d)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[n,a,s]},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={1490:0,2371:0,4193:0,4607:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var a,s,[i,r,c]=n,d=0;if(i.some((t=>0!==e[t]))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(c)var l=c(o)}for(t&&t(n);d<i.length;d++)s=i[d],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(l)},n=globalThis.webpackChunkevent_tickets=globalThis.webpackChunkevent_tickets||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=o.O(void 0,[4607],(()=>o("v7al")));a=o.O(a),window.tec=window.tec||{},window.tec.tickets=window.tec.tickets||{},window.tec.tickets.seating=window.tec.tickets.seating||{},window.tec.tickets.seating.admin=window.tec.tickets.seating.admin||{},window.tec.tickets.seating.admin.mapEdit=a})();